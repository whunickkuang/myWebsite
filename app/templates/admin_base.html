{% from "html_utils.html" import css_file, js_file %}
{% set eps_format = "%.4f" %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>桥梁短线法施工辅助系统</title>
    {{ css_file("libs/bootstrap/css/bootstrap.min.css") }}
    {{ css_file("libs/themes/inspinia/font-awesome/css/font-awesome.css") }}
    {{ css_file("css/bootstrap-select.min.css") }}

    {{ css_file("libs/themes/inspinia/css/animate.css") }}
    {{ css_file("libs/themes/inspinia/css/style.css") }}

    {{ css_file("css/admin.css") }}
{#    {{ css_file("css/chart.css")}}#}
    {% block css %}{% endblock %}
</head>
<body>

<div id="wapper">
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">

            <ul class="nav" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element"> <span>
                        <img alt="image" class="img-circle" src="{{ url_for('static',filename='images/profile_small.png') }}">
                             </span>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear">
                                <span class="block m-t-xs">
                                <strong class="font-bold">
                                    {{ current_user.user_name }}
{#                                    {{ session['user_name'] or "游客" }}#}
                                </strong>
                                </span>
                                <span class="text-muted text-xs block">
                                    {% if current_user.user_role_type=='普通用户' %}
                                    {{ session['project_default_role'] }}
                                    {% else %}
                                    {{ current_user.user_role_type }}
                                    {% endif %}
{#                                    {{ session['project_default_role'] or "普通客户" }}#}
                                    <b class="caret"></b>
                                </span>
                            </span>
                        </a>
                        <ul class="dropdown-menu animated fadeInRight m-t-xs">
                            <li><a href="{{ url_for('main.individual_info_display',userId=current_user.user_id) }}">个人资料</a></li>
                            <li><a href="{{ url_for('main.change_password') }}">修改密码</a></li>
                            <li><a href="{{ url_for('main.change_email') }}">修改邮箱</a></li>
                            <li class="divider"></li>
                            <li><a href="{{ url_for('main.logout') }}">退出</a></li>
                        </ul>
                    </div>
                    <div class="logo-element">
                        桥+
                    </div>
                </li>
                {% if current_user.user_role_type=='平台管理员' %}
                    <li>
                        <a href="#">
                            <i class="fa fa-users"></i>
                            <span class="nav-label">组织管理</span> <span
                                class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li id="menu_organization_new">
                                <a href="{{ url_for('main.admin_organization_new') }}"><i class="fa fa-user-plus"></i>新建组织</a>
                            </li>
                            <li id="menu_organization_list">
                                <a href="{{ url_for('main.admin_organization_list') }}"><i class="fa fa-list-ol"></i>组织列表</a>
                            </li>
                           <li id="menu_users_list">
                                <a href="{{ url_for('main.admin_users_list') }}"><i class="fa fa-user"></i>用户列表</a>
                           </li>

                        </ul>
                    </li>
                {% endif %}
                {% if current_user.user_role_type=='公司管理员'or current_user.can(1, session['project_id']) %}
                    <li>
                        <a href="#">
                            <i class="fa fa-th-large"></i>
                            <span class="nav-label">项目管理</span> <span
                                class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
{#                            {% if current_user.user_role_type=='公司管理员' %}#}
{#                                <li id="menu_project_new">#}
{#                                    <a href="{{ url_for('main.admin_edit_project', projectId = 'new') }}"><i class="fa fa-plus"></i>新建项目</a>#}
{#                                </li>#}
{#                            {% endif %}#}
                            <li id="menu_project_list">
                                <a href="{{ url_for('main.admin_project_list') }}"><i class="fa fa-list-ul"></i> 项目列表</a>
                            </li>

                        </ul>
                    </li>
                {% endif %}
                {% if current_user.user_role_type!='平台管理员' %}
                    {% if current_user.user_role_type=='公司管理员'or current_user.can(256, session['project_id']) %}
                        <li>
                            <a href="#">
                            <i class="fa fa-users"></i>
                                <span class="nav-label"> 人员管理</span> <span
                                class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">

                                <li id="menu_user_list">
                                    <a href="{{ url_for('main.admin_user_list') }}"><i class="fa fa-list-ol"></i> 人员列表</a>
                                </li>
                            </ul>


                        </li>
                    {% endif %}
                {% endif %}
                {% if current_user.can(2, session['project_id'])or current_user.user_role_type=='公司管理员' %}

                    <li><a href="#"><i class="fa fa-cube"></i>
                        <span class="nav-label">台座管理</span> <span
                            class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
{#                            <li id="menu_bed_new">#}
{#                                <a href="{{ url_for('main.admin_bed_new') }}"><i class="fa fa-gears"></i> 新建台座</a>#}
{#                            </li>#}
                            <li id="menu_bed_list">
                                <a href="{{ url_for('main.admin_bed_list') }}"><i class="fa fa-list-alt"></i> 台座列表</a>
                            </li>
                        </ul>

                    </li>
                {% endif %}

                {% if current_user.can(4, session['project_id']) or current_user.user_role_type=='公司管理员' %}
                    <li><a href="#">
                        <i class="fa fa-sitemap"></i>
                        <span class="nav-label"> 模型管理</span> <span
                            class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">

                            <li id="menu_model_list">
                                <a href="{{ url_for('main.admin_model_list') }}"><i class="fa fa-list-ul"></i> 模型列表</a>
                            </li>
                        </ul>

                    </li>
                {% endif %}

                {% if current_user.can(8, session['project_id']) or current_user.user_role_type=='公司管理员' %}
                    <li><a href="#">
                        <i class="fa fa-area-chart"></i>
                        <span class="nav-label"> 回测数据管理</span> <span
                            class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                   <li id="menu_surveyed_data_list">
                            <li id="menu_surveyed_data_list">
                                    <a href="{{ url_for('main.admin_surveyed_data_list',user_id=current_user.user_id,selected_id=1) }}"><i class="fa fa-reorder "></i> 回测数据列表</a>
                                </li>
                        </ul>
                    </li>
                {% endif %}

                {% if current_user.can(16, session['project_id']) or current_user.user_role_type=='公司管理员' %}
                    <li><a href="#">
                        <i class="fa fa-edit"></i>
                        <span class="nav-label"> 施工指令管理</span> <span
                            class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">

                            <li id="menu_construction_order_list">
                                <a href="{{ url_for('main.admin_construction_order_list') }}"><i class="fa fa-list-ol"></i> 施工指令列表</a>
                            </li>
                        </ul>

                    </li>
                {% endif %}

            </ul>
        </div>
    </nav>

    <div id="page-wrapper" class="gray-bg">

        <div class="row border-bottom">
            <nav class="navbar navbar-static-top  " role="navigation" style="margin-bottom: 0">
                <div class="navbar-header">
                    <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i>
                    </a>
                    {#"查询功能 可贴入函数"#}
                    <form role="search" class="navbar-form-custom">
                        <div class="form-group">
                            <input type="text" placeholder="" class="form-control"
                                   name="top-search" id="top-search">
                        </div>
                    </form>
                </div>
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <span class="m-r-sm text-muted welcome-message">欢迎来到桥+系统</span>
                    </li>
                    <li>
                        <a href="{{ url_for('main.login') }}">
                            <i class="fa fa-home"></i> 首页
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('main.admin_add_setting') }}">
                            <i class="fa fa-cube"></i>工程设置
                        </a>
                    </li>
                    <li>
                        <div class="dropdown ">
                                <a  data-toggle="dropdown" class="dropdown-toggle" href="#">
                                    示例文件
                                </a>
                            <ul class="dropdown-menu animated m-t-xs">
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/101.xls") }}">101.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/102order2015-08-06-1109-42.xls") }}">102order2015-08-06-1109-42.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/103order2015-08-12-21-27.xls") }}">103order2015-08-12-21-27.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/104order2015-08-12-21-29.xls") }}">104order2015-08-12-21-29.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/bed.xls") }}">bed.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/model.xls") }}">model.xls</a>
                                </li>
                                <li>
                                    <a href="{{ url_for('static', filename = "demoFile/demofile.zip") }}">demofile.zip</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li>
                        {% if current_user.user_role_type=='普通用户' or current_user.user_role_type=='公司管理员'%}

                            <div class="dropdown ">

                                <a id="navProjectDrop" data-toggle="dropdown" class="dropdown-toggle" href="#">
                                    {{ session['project_default_name'] }}
                                </a>
                                <ul id="navProjectList" class="dropdown-menu animated fadeInRight m-t-xs">
                                    {% for id_name_dict in session['project_list'] %}
                                        {% for project_id in id_name_dict %}
                                            <li>
                                                <a href="{{ url_for('main.change_project',projectId=project_id) }}">{{ id_name_dict[project_id] }}</a>
                                            </li>

                                        {% endfor %}
                                    {% endfor %}

                                </ul>
                            </div>
                        {% endif %}

                    </li>
                    <li>
                        <a href="{{ url_for('main.logout') }}">
                            <i class="fa fa-sign-out"></i> 退出
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="row wrapper border-bottom white-bg page-heading">
            <h2>{% block mainTitle %}{% endblock %}</h2>
        {% block breadcrumbs %}{% endblock %}
        </div>
        <div class="row">
            <div class="col-lg-12">
                {% block content %}
                        {% for message in get_flashed_messages() %}
                            <div class="alert alert-warning">
                                <button type="button" class="close" data-dismiss="alert">&times;</button>
                                {{ message }}
                            </div>
                        {% endfor %}

                                    {% block notes %}{% endblock %}
                                    {% block mainContent %}{% endblock %}
                {% endblock %}
            </div>
        </div>
    </div>
</div>
<!-- Mainly scripts -->
{{ js_file("libs/jquery/jquery-2.1.1.js") }}
{{ js_file("libs/themes/inspinia/js/bootstrap.min.js") }}
{{ js_file("libs/themes/inspinia/js/inspinia.js") }}
{{ js_file("libs/themes/inspinia/js/ajaxfileupload.js") }}
{{ js_file("libs/plugins/metisMenu/jquery.metisMenu.js") }}
{{ js_file("libs/plugins/slimscroll/jquery.slimscroll.min.js") }}
{{ js_file("libs/plugins/pace/pace.min.js") }}
{{ js_file("libs/plugins/iCheck/icheck.min.js") }}
{{ js_file("js/bootstrap-select.min.js") }}
{#{{ js_file("js/chart.js")}}#}
{#{{ js_file("js/jquery.tablescroll.js")}}#}
{#{{ js_file("js/scroll_table.js")}}#}


{% block otherjs %}
{% endblock %}
{% block js %}{% endblock %}
<script>
    $(function () {
        if($("#{{ activeMenu }}").parent().hasClass("nav-second-level")) {
            $("#{{ activeMenu }}").addClass("active");
            $("#{{ activeMenu }}").parent().addClass("in");
            $("#{{ activeMenu }}").parent().parent().addClass("active");
        } else{
            $("#{{ activeMenu }}").addClass("active");
        }
    });
</script>
<script>
    $(function(){
         $("#demofile").change(function(){
                filename=$(this).children("option:selected").val();
                window.location = '/static/demoFile/'+filename;
            })z
    })
</script>
{% block otherContents %}{% endblock %}
</body>
</html>